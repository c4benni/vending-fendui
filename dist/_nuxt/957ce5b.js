(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{529:function(t,e,r){var content=r(532);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(40).default)("fe163416",content,!0,{sourceMap:!1})},531:function(t,e,r){"use strict";r(529)},532:function(t,e,r){var n=r(39)((function(i){return i[1]}));n.push([t.i,".root[data-oqy]{--size:52px;display:inline-grid;grid-template-columns:repeat(3,auto);height:var(--size);position:relative;border-radius:8px;margin:.5rem 0 0;isolation:isolate;--ui-divide:1px solid var(--divide-color);--divide-color:hsla(0,0%,100%,0.192)}html.light .root[data-oqy]{--divide-color:rgba(0,0,0,0.292)}.root[data-oqy]:before{border:var(--ui-divide);border-width:1px;z-index:1}.root.__disabled[data-oqy]{opacity:var(--t-disabled)}.root[data-oqy]:after{width:6.35rem;height:calc(100% + 9px);left:var(--size);top:-4.5px;border-radius:6px;border:3px solid var(--info);opacity:0}@media (hover:hover) and (pointer:fine){.root[data-oqy]:after{transition:opacity .2s}.root[data-oqy].hover:after{opacity:.4}}.root[data-oqy].focused:after,input[data-oqy]{opacity:var(--t-body)}input[data-oqy]{background-color:transparent;border:none;text-align:center;font-size:1.75rem;color:var(--theme-surface-text);width:6.35rem;caret-color:var(--theme-surface-text);outline:none;border:var(--ui-divide);border-width:0 1px;border-radius:0;font-family:var(--monospace);transition:opacity .2s;-webkit-appearance:none;-moz-appearance:none;appearance:none}input[data-oqy]::-webkit-inner-spin-button,input[data-oqy]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}input[data-oqy][type=number]{-moz-appearance:textfield}.root.__disabled[data-oqy] input{opacity:var(--t-disabled);pointer-events:none}.root[data-oqy]>.ui-btn{width:var(--size)!important;max-width:var(--size)!important;height:var(--size)!important;max-height:var(--size)!important;border-radius:0;background:var(--theme-primary);background:var(--btn-color,var(--theme-primary));opacity:var(--t-title)}.root[data-oqy]>.ui-btn.__disabled{opacity:.5!important}.root[data-oqy] .ui-icon{opacity:1!important}.root[data-oqy]>.ui-btn.__disabled .ui-icon{opacity:.5!important}",""]),n.locals={},t.exports=n},533:function(t,e,r){"use strict";r(48);var n={name:"AppRating",props:{readonly:Boolean},data:function(){return{rating:4}},render:function(t){var e=this;if(!this.$ui.mounted)return null;var div=function(e,r){return t("div",e,r)};return div({class:["grid grid-flow-col items-center justify-start"],on:{click:function(){}}},[1,2,3,4,5].map((function(r,n){var o,c,l=(null==e?void 0:e.rating)&&e.rating>=r;return function(e,r){return t("uiBtn",e,r)}({key:n+"rating",class:["rating w-[32px] h-[32px] min-h-[32px] p-0 rounded-full before:bg-yellow-500 hover:bg-opacity-100",{"text-yellow-500":l}],size:"sm",readonly:e.readonly,on:{click:function(){e.rating==r?e.rating=null:e.rating=r}}},[div({staticClass:"flex",class:[{"fade-appear opacity-1":l,"opacity-[0.65]":!l}]},[(o={props:{name:l?"star":"starOutline",size:"16px"}},t("uiIcon",o,c))])])})))}},o=r(17),component=Object(o.a)(n,undefined,undefined,!1,null,null,null);e.a=component.exports},534:function(t,e,r){"use strict";r(21),r(14),r(18),r(8),r(22),r(13),r(23);var n=r(6);r(88);function o(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}function c(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?o(Object(source),!0).forEach((function(e){Object(n.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):o(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var l={name:"OrderQuantity",model:{prop:"vmodel",event:"vmodel"},props:{useChevron:Boolean,step:{type:[String,Number],default:1},vmodel:{type:[Number,String],default:1},disabled:Boolean,id:{type:String,default:void 0},max:{type:[String,Number],default:99},min:{type:[String,Number],default:1}},data:function(){return{inputFocused:!1,selfName:"OrderQuantity"}},computed:{parseStep:function(){return parseFloat(this.step)},parseVmodel:function(){return this.vmodel}},watch:{max:function(t){this.parseVmodel>=+t&&this.$emit("vmodel",t)}},render:function(t){var e,r=this,n={"data-oqy":""},o=function(e){var o,l,d=e.disabled,f=e.iconName,m=e.staticClass,h=e.click;return function(e,r){return t("ui-btn",e,r)}({props:{icon:!0,flat:!0,disabled:r.disabled||d,persistent:!0,text:!0},attrs:c(c({},n),{},{title:"plus"==f?"increase":"reduce"}),staticClass:m,class:[r.disabled||d?"bg-none":"before:bg-blue-700"],on:{click:h}},[(o={attrs:{name:"".concat(f)}},t("ui-icon",o,l))])};return function(e,r){return t("div",e,r)}({attrs:c({},n),staticClass:"root fill-before-after",class:[{focused:this.inputFocused,__disabled:this.disabled}]},[o({disabled:this.parseVmodel<=this.min,iconName:this.useChevron?"chevronLeft":"minus",click:function(){r.parseVmodel>r.min&&r.$nextTick((function(){r.$emit("vmodel",r.parseVmodel-r.parseStep)}))},staticClass:"rounded-l-sm"}),(e={attrs:c(c({},n),{},{type:this.disabled?"text":"number",pattern:"\\d*",title:"enter quantity",tabindex:this.disabled?"-1":void 0,id:this.id,readonly:this.disabled,step:this.step,min:this.min,max:this.max}),domProps:{value:this.disabled?"--":parseFloat(this.parseVmodel)},class:[{"opacity-50":this.disabled}],on:{focus:function(){r.inputFocused=!0},blur:function(){r.inputFocused=!1},input:function(t){var e=parseFloat(t.currentTarget.value);r.$emit("vmodel",e)},change:function(t){var e=parseFloat(t.currentTarget.value);e&&0!=e?e>r.max&&(e=parseFloat(r.max)):e=parseFloat(r.min);var n=r.parseStep,o=e%n;o&&(o<3?e-=o:e+=n-o),r.$emit("vmodel",e)}}},t("input",e)),o({disabled:this.parseVmodel>=this.max,iconName:this.useChevron?"chevronRight":"plus",click:function(){r.parseVmodel<r.max&&r.$nextTick((function(){r.$emit("vmodel",r.parseVmodel+r.parseStep)}))},staticClass:"rounded-r-sm"})])}},d=(r(531),r(17)),component=Object(d.a)(l,undefined,undefined,!1,null,null,null);e.a=component.exports},566:function(t,e,r){"use strict";r.r(e);r(14),r(18),r(8),r(22),r(13),r(23);var n=r(0),o=r(6),c=(r(24),r(21),r(90)),l=r(197),d=(r(46),r(304),r(534)),f=r(533),main=r(3),m=function(t){return h.apply(this,arguments)};function h(){return(h=Object(n.a)(regeneratorRuntime.mark((function t(e){var r,data,o,c=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(main.o)(Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.$axios.post("buy",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))));case 2:if(r=t.sent,data=r.data,o=r.error){t.next=8;break}return t.next=8,this.$refreshUser();case 8:return t.abrupt("return",{data:data,error:o});case 9:case"end":return t.stop()}}),t,this)})))).apply(this,arguments)}function v(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}function y(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?v(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):v(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var x={name:"ProductDetail",components:{AppRating:f.a,OrderQuantity:d.a},data:function(){return{purchasing:!1,loading:!0,quantity:1}},head:function(){var t=this.product.productName;return{title:this.loading?"Loading product":t?"Shop ".concat(t):"Failed to fetch"}},computed:y(y({},Object(c.c)(["products"])),{},{product:function(){return this.products[this.id]||{}},ownerDeleted:function(){return this.product.ownerDeleted},purchaseHint:function(){return this.product.ownerDeleted?"Product owner deleted. Please try another product.":this.soldOut?"Item is out of stock. Check back later.":this.insufficientDeposit?"Deposit more coins and try again.":"You spend ".concat(this.getTotalCost," in total")},stockBadge:function(){var t=this.productStock;return this.soldOut?"Out of stock":"".concat(t," item").concat(t>1?"s":""," left")},productCost:function(){return Object(main.f)(this.product.cost)},productStock:function(){return parseInt(this.product.amountAvailable||0)},soldOut:function(){return!this.productStock},getTotalCost:function(){var t=this.product.cost*this.quantity;return t>99?"$".concat((t/100).toFixed(2)):"¢".concat(t)},id:function(){return this.$route.query.id},user:function(){return this.$store.state.user||{}},disableQuantity:function(){return!this.requiredCoin},insufficientDeposit:function(){return parseFloat(this.product.cost)*this.quantity>parseFloat(this.user.deposit)},disablePurchase:function(){return this.soldOut||this.insufficientDeposit||this.isSeller},isSeller:function(){return"seller"==this.user.role},purchaseText:function(){if(this.isSeller)return"Buyers only!";if(this.product.ownerDeleted)return"Owner deleted";if(this.soldOut)return"Sold out";var text=this.insufficientDeposit?"Insufficient coins":"Purchase";return this.purchasing?"":text},showDeposit:function(){return!(this.disablePurchase||this.isSeller||this.soldOut||this.ownerDeleted)}}),created:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!t.product.id,e.next=3,t.fetchProduct();case 3:case"end":return e.stop()}}),e)})))()},methods:y(y({},Object(c.b)(["getProduct"])),{},{fetchProduct:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getProduct(t.id);case 2:t.loading=!1,t.$commit("UPDATE",{path:"productName",value:t.product.productName});case 4:case"end":return e.stop()}}),e)})))()},purchase:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var r,data,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.disablePurchase&&!t.isSeller){e.next=2;break}return e.abrupt("return",null);case 2:return t.$commit("UPDATE",{path:"processingDone",value:null}),e.next=5,t.$nextTick();case 5:return t.purchasing=!0,e.next=8,m.call(t,{id:t.id,amount:t.quantity});case 8:return r=e.sent,data=r.data,n=r.error,t.purchasing=!1,t.$commit("UPDATE",{path:"dashboardProcessing",value:!0}),e.next=15,t.$nextTick();case 15:return t.$commit("UPDATE",{path:"processingDone",value:{title:n?"An error occured":"Purchase successful",subtitle:(null==n?void 0:n.message)||(null==data?void 0:data.message),error:!!n,key:Date.now(),change:null==data?void 0:data.change,changeTotal:null==data?void 0:data.changeTotal}}),t.quantity=1,e.next=19,t.$refreshUser();case 19:return e.next=21,t.fetchProduct();case 21:case"end":return e.stop()}}),e)})))()}})},w=r(17);function O(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}function j(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?O(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):O(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var k={components:{productDetail:Object(w.a)(x,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"card min-h-[360px] lg:min-h-[510px] mx-auto w-full relative lg:p-2 p-0 grid lg:grid-flow-col lg:grid-cols-[auto,1fr] before-divide before:border fill-before before:opacity-[0.05]"},[t.loading?r("div",{staticClass:"h-full w-full absolute grid place-items-center top-0"},[r("div",{staticClass:"spinner-border",staticStyle:{"--size":"2rem"}})]):[r("div",{staticClass:"w-[calc(100%-1rem)] h-[360px] lg:w-[490px] lg:h-[510px] rounded-sm bg-white dark:bg-blue-gray-900 shadow-md justify-self-center mt-2 lg:mt-0 isolate overflow-hidden"},[r("app-img",{staticClass:"h-full object-cover",attrs:{"public-id":t.product.background}})],1),t._v(" "),r("div",{staticClass:"grid lg:p-2 p-4 lg:pl-4 pt-6 lg:pt-6 pb-10 lg:pb-0 content-start"},[r("p",{staticClass:"text-sm font-medium opacity-70 capitalize"},[t._v(t._s(t.product.type))]),t._v(" "),r("p",{staticClass:"text-xl font-bold py-1 capitalize"},[t._v(t._s(t.product.productName))]),t._v(" "),t.product.caption?r("p",{staticClass:"text-[0.9rem] mb-2 font-light opacity-80"},[t._v(t._s(t.product.caption))]):t._e(),t._v(" "),r("AppRating"),t._v(" "),r("div",{staticClass:"before-divide before:border-b fill-before pb-4 relative mt-3 flex justify-between items-center"},[r("p",{staticClass:"text-xl font-bold"},[t._v(t._s(t.productCost))]),t._v(" "),r("div",{staticClass:"rounded-full px-2 py-1 bg-opacity-75 dark:bg-opacity-75 text-[0.8rem]",class:{"bg-green-800 text-white":t.productStock>=10,"bg-yellow-500 text-black":t.productStock<10&&t.productStock>4,"bg-red-800 text-white":t.productStock<5}},[t._v(t._s(t.stockBadge))])]),t._v(" "),r("p",{staticClass:"text-sm font-medium opacity-70 mt-4"},[t._v("Choose quantity")]),t._v(" "),r("OrderQuantity",{staticClass:"justify-self-start mb-12",attrs:{disabled:t.isSeller||t.soldOut,max:t.productStock},model:{value:t.quantity,callback:function(e){t.quantity=e},expression:"quantity"}}),t._v(" "),r("ui-btn",{staticClass:"min-w-[200px] h-[48px] mx-auto grid w-[min(70%,300px)]",class:{"bg-blue-800 text-white dark:bg-blue-400 dark:text-black":!t.disablePurchase&&!t.ownerDeleted},attrs:{disabled:t.disablePurchase||t.ownerDeleted},on:{click:t.purchase}},[t._v("\n                "+t._s(t.purchaseText)+"\n                "),t.purchasing?r("div",{staticClass:"spinner-border"}):t._e()]),t._v(" "),t.isSeller?r("p",{staticClass:"text-sm font-light mt-2 text-center opacity-70"},[t._v("You need to create a buyer's account first.")]):r("p",{staticClass:"text-sm font-light mt-2 text-center opacity-70"},[t._v(t._s(t.purchaseHint))]),t._v(" "),t.showDeposit?r("ui-btn",{staticClass:"min-w-[200px] h-[48px] mx-auto grid w-[min(70%,300px)] text-blue-800 dark:text-blue-500 fade-appear hover:underline font-medium mt-6 ring-1",attrs:{to:"/dashboard/deposit"}},[t._v("Deposit coins")]):t._e()],1)]],2)}),[],!1,null,null,null).exports,AppImg:l.default},data:function(){return{loading:!0,errorFetching:null}},head:function(){return{title:"Shop products"}},computed:j(j({},Object(c.c)(["products"])),{},{productsLength:function(){return console.log(Object.keys(this.products).length),Object.keys(this.products).length},queryId:function(){return this.$route.query.id},media:function(){return this.$store.state.media}}),watch:{queryId:function(){scrollTo(0,0)}},created:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!t.productsLength,e.next=3,t.getItems();case 3:case"end":return e.stop()}}),e)})))()},methods:j(j({},Object(c.b)(["getProducts"])),{},{getItems:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getProducts();case 2:t.loading=!1;case 3:case"end":return e.stop()}}),e)})))()}})},_=Object(w.a)(k,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.queryId?r("product-detail",{attrs:{"query-id":t.queryId}}):t.loading?r("div",{staticClass:"w-full py-[128px] grid justify-center justify-items-center items-center"},[r("div",{staticClass:"spinner-border",staticStyle:{"--size":"1.75rem"}}),t._v(" "),r("p",{staticClass:"mt-2 text-sm opacity-60"},[t._v("LOADING...")])]):t.productsLength?r("div",{staticClass:"grid grid-cols-[repeat(auto-fill,minmax(40%,180px))] lg:grid-cols-[repeat(auto-fill,minmax(30%,200px))] justify-center lg:gap-4 gap-2 lg:p-3 py-3 lg:w-[calc(100vw-280px)] xl:w-[calc(calc(min(100vw,1920px)-3rem)-280px)] w-full"},t._l(t.products,(function(e,i){return r("ui-btn",{key:i,staticClass:"grid-flow-row text-left bg-white dark:bg-blue-gray-900 dark:bg-opacity-50 w-full p-0 justify-stretch transform-gpu transition-transform hover:translate-y-[-0.25rem] hover:shadow-lg",attrs:{tag:"nuxt-link",to:"/dashboard/shop?id="+e.id,outlined:"","outlined-storke":t.$theme.light?"0.75px":"0.5px","outlined-opacity":t.$theme.light?"0.1":"0.05"}},[r("div",{staticClass:"h-[128px] lg:h-[224px] w-full mb-4 relative fill-before before-divide before:border-b"},[r("app-img",{staticClass:"h-full object-cover",attrs:{"public-id":e.background}})],1),t._v(" "),r("div",{staticClass:"px-2 pb-3 lg:px-3 overflow-hidden"},[r("p",{staticClass:"capitalize truncate opacity-70 mb-1 text-sm font-normal"},[t._v(t._s(e.type))]),t._v(" "),r("p",{staticClass:"truncate mb-2 capitalize"},[t._v(t._s(e.productName))]),t._v(" "),r("p",{staticClass:"text-sm opacity-80"},[t._v("¢"+t._s(e.cost))])])])})),1):r("div",{staticClass:"lg:w-[calc(100vw-280px)] xl:w-[calc(calc(min(100vw,1920px)-3rem)-280px)] w-full pb-6 min-h-screen"},[r("div",{staticClass:"min-h-[200px] grid justify-center"},[r("app-img",{attrs:{"public-id":t.media.empty,height:"200px"}})],1),t._v(" "),r("p",{staticClass:"mt-6 font-semibold text-lg text-center"},[t._v("The shop is empty!")])])}),[],!1,null,null,null);e.default=_.exports}}]);