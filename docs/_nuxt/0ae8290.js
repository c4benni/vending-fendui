(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{533:function(t,e,r){"use strict";r(48);var n={name:"AppRating",props:{readonly:Boolean},data:function(){return{rating:4}},render:function(t){var e=this;if(!this.$ui.mounted)return null;var div=function(e,r){return t("div",e,r)};return div({class:["grid grid-flow-col items-center justify-start"],on:{click:function(){}}},[1,2,3,4,5].map((function(r,n){var o,c,d=(null==e?void 0:e.rating)&&e.rating>=r;return function(e,r){return t("uiBtn",e,r)}({key:n+"rating",class:["rating w-[32px] h-[32px] min-h-[32px] p-0 rounded-full before:bg-yellow-500 hover:bg-opacity-100",{"text-yellow-500":d}],size:"sm",readonly:e.readonly,on:{click:function(){e.rating==r?e.rating=null:e.rating=r}}},[div({staticClass:"flex",class:[{"fade-appear opacity-1":d,"opacity-[0.65]":!d}]},[(o={props:{name:d?"star":"starOutline",size:"16px"}},t("uiIcon",o,c))])])})))}},o=r(17),component=Object(o.a)(n,undefined,undefined,!1,null,null,null);e.a=component.exports},568:function(t,e,r){"use strict";r.r(e);r(21),r(14),r(22),r(13),r(23);var n=r(0),o=r(6),c=(r(24),r(143),r(19),r(75),r(199),r(18),r(8),r(530),r(46),r(90)),d=r(196),l=r(533),h=(r(87),r(108),r(63),r(47),r(541)),main=r(3);function v(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}function f(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?v(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):v(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var m={components:{ProductForm:h.a},data:function(){return{loading:!0,errorFetching:null,product:{productName:"Loading title",caption:null,description:null,type:null,cost:null,amountAvailable:null},detailsValidity:{caption:!0,description:!0},form:{type:null,cost:null,inventory:null},selectedType:""}},head:function(){return{title:this.loading?"Loading product":"Editing product ".concat(this.product.productName)}},computed:{disableUpdate:function(){var t=Object.values(this.detailsValidity).includes(!1),e=this.form,r=e.type,n=e.cost,o=e.inventory;return t||!r||!n||!o},id:function(){return this.$route.query.edit},fields:function(){return{name:{value:this.product.productName||"Loading...",disabled:!0},caption:{value:this.product.caption},description:{value:this.product.description},type:{value:this.product.type||"Loading...",disabled:!0},cost:{value:parseFloat(this.product.cost)||"Loading"},inventory:{value:parseFloat(this.product.amountAvailable||-1)}}}},created:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.fetchProduct();case 2:case"end":return e.stop()}}),e)})))()},mounted:function(){scrollTo(0,0)},methods:{fetchProduct:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var r,data,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,e.next=3,t.$apiCall("product?id=".concat(t.id));case 3:r=e.sent,data=r.data,n=r.error,t.loading=!1,data?(t.product=f({},data),t.$commit("UPDATE",{path:"productName",value:data.productName})):t.errorFetching=f(f({},n),{},{message:Object(main.c)(n.message||"An error occured")});case 8:case"end":return e.stop()}}),e)})))()},formUpdated:function(t){this.form=t.form;var e=t.detailsValidity,caption=e.caption,r=e.description;this.detailsValidity={caption:caption,description:r},this.selectedType=t.selectedType},updateProduct:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var r,caption,n,o,c,d,l,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.disableUpdate){e.next=2;break}return e.abrupt("return",null);case 2:return t.$commit("UPDATE",{path:"processingDone",value:null}),e.next=5,t.$nextTick();case 5:return t.$commit("UPDATE",{path:"processingDone",value:{title:"Updating product",subtitle:"Please wait while we update your product."}}),e.next=8,t.$nextTick();case 8:return t.$commit("UPDATE",{path:"dashboardProcessing",value:!0}),r=t.form,caption=r.caption,n=r.description,o=r.cost,c=r.inventory,d={id:t.id,amountAvailable:c,cost:o,type:t.selectedType.toLowerCase()},caption&&(d.caption=caption),n&&(d.description=n),e.next=15,t.$dispatch("updateProduct",d);case 15:if(l=e.sent,h=l.error,t.$commit("UPDATE",{path:"processingDone",value:{title:h?"An error occured":"Product updated",subtitle:h?"":"Your product has been successfully updated!"}}),h){e.next=22;break}return e.next=21,t.$sleep(100);case 21:t.$router.push("/dashboard/my-products");case 22:case"end":return e.stop()}}),e)})))()},deleteProduct:function(){var t,e=this;this.$commit("UPDATE",{path:"notify",value:{message:"Are you sure you want to delete this product? This action cannot be reversed.",error:!0,closeText:"Delete product",callback:(t=Object(n.a)(regeneratorRuntime.mark((function t(){var r,data,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.$commit("UPDATE",{path:"notify",value:{message:null}}),e.$commit("UPDATE",{path:"processingDone",value:null}),t.next=4,e.$nextTick();case 4:return e.$commit("UPDATE",{path:"dashboardProcessing",value:!0}),e.$commit("UPDATE",{path:"processingDone",value:{title:"Deleting product",subtitle:"Please wait while we delete your product.",key:Date.now()}}),t.next=8,e.$dispatch("deleteProduct",e.id);case 8:return r=t.sent,data=r.data,n=r.error,t.next=13,e.$sleep(100);case 13:if(e.$commit("UPDATE",{path:"processingDone",value:{title:n?"An error occured":"Product created",subtitle:(null==n?void 0:n.message)||(null==data?void 0:data.message),error:!!n,key:Date.now()}}),n){t.next=18;break}return t.next=17,e.$sleep(100);case 17:e.$router.replace("/dashboard/my-products");case 18:case"end":return t.stop()}}),t)}))),function(){return t.apply(this,arguments)}),key:Date.now()}})}}},y=m,x=r(17),w=Object(x.a)(y,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.loading?r("div",{staticClass:"grid h-screen w-full justify-center items-start mt-[48px]"},[r("div",{staticClass:"spinner-border"})]):t.errorFetching?r("div",{staticClass:"grid h-screen w-full justify-center items-start"},[r("p",{staticClass:"font-bold mt-[48px]"},[t._v(t._s(t.errorFetching.message))])]):r("ProductForm",{key:t.id+""+t.loading,staticClass:"fade-appear",attrs:{fields:t.fields},on:{"update-parent":t.formUpdated}},[r("ui-btn",{staticClass:"gap-x-2 w-8/12 h-[48px] mx-auto",class:{"bg-blue-700 text-white hover:bg-blue-800 active:bg-blue-900 dark:bg-blue-500 dark:text-black dark:hover:bg-blue-600 dark:hover:bg-opacity-70 dark:active:bg-blue-700 dark:active:bg-opacity-60":!t.disableUpdate},attrs:{disabled:t.disableUpdate},on:{click:t.updateProduct}},[r("ui-icon",{attrs:{name:"update"}}),t._v("Update product\n    ")],1),t._v(" "),r("ui-btn",{staticClass:"gap-x-2 w-8/12 h-[48px] mx-auto mt-8 mb-3 text-bg-red-800 hover:bg-red-800 hover:text-white active:bg-red-900 active:text-white dark:text-red-500 dark:hover:text-white dark:hover:bg-red-600 dark:hover:bg-opacity-70 dark:active:bg-red-700 dark:active:text-white dark:active:bg-opacity-60",attrs:{outlined:""},on:{click:t.deleteProduct}},[r("ui-icon",{attrs:{name:"delete"}}),t._v("Delete this product\n    ")],1)],1)}),[],!1,null,null,null).exports;function k(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}function P(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?k(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):k(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var O={components:{uiIcon:d.default,appRating:l.a,editProduct:w},data:function(){return{search:"",sortBy:"",loading:!0,errorFetching:{message:"",status:null},tableHead:["Name","Stock","Price","Rating","Id"]}},head:function(){return{title:"My products"}},computed:P(P({},Object(c.c)(["products"])),{},{isEditing:function(){return!!this.$route.query.edit},user:function(){return this.$store.state.user},getProducts:function(){var t=new RegExp("".concat(this.search),"i");return Object.values(this.products).filter((function(e){return t.test(e.productName)}))},notFound:function(){return 404==this.errorFetching.status},getErrorMessage:function(){return this.notFound?"You have nothing to show":this.errorFetching.message},errorBtn:function(){var t=this.notFound;return{text:t?"Create a product":"Retry",to:t?"/dashboard/create-product":void 0}}}),watch:{isEditing:function(t){scrollTo(0,0),t||this.fetchProducts()}},created:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.fetchProducts();case 2:case"end":return e.stop()}}),e)})))()},activated:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.fetchProducts();case 2:case"end":return e.stop()}}),e)})))()},methods:{capitalize:function(t){return Object(main.c)(t)},parseInt:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t){return parseInt(t)})),formatRemaining:function(t){var e=parseInt(t.amountAvailable);return e?"".concat(e," item").concat(e>1?"s":""," left"):"Sold out"},fetchProducts:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$dispatch("getProducts",'?where={"sellerId":"'.concat(t.user.id,'"}'));case 2:r=e.sent,r.data||(t.errorFetching={message:"You have nothing to show",status:404}),t.loading=!1;case 6:case"end":return e.stop()}}),e)})))()}}},j=O,_=Object(x.a)(j,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.isEditing?r("edit-product"):t.loading||t.errorFetching.message?r("div",{staticClass:"card min-h-[128px] grid justify-center items-center mx-6"},[t.errorFetching.message?r("div",{staticClass:"grid justify-items-center"},[r("p",{staticClass:"mb-3"},[t._v("\n            "+t._s(t.getErrorMessage)+"\n        ")]),t._v(" "),r("ui-btn",{staticClass:"bg-blue-700 text-white hover:bg-blue-800 active:bg-blue-900 dark:bg-blue-500 dark:text-black dark:hover:bg-blue-600 dark:hover:bg-opacity-70 dark:active:bg-blue-700 dark:active:bg-opacity-60",attrs:{to:t.errorBtn.to}},[t._v(t._s(t.errorBtn.text))])],1):r("div",{staticClass:"spinner-border"})]):r("div",[r("div",{staticClass:"card p-0 mx-6 shadow-md dark:shadow-none fade-appear overflow-hidden"},[r("form",{staticClass:"h-[64px] px-6 relative fill-before before-divide before:border-b isolate",attrs:{action:".",name:"search-products"}},[r("div",{staticClass:"absolute left-6 top-[50%] translate-y-[-50%] w-[24px] h-[24px] z-10"},[r("ui-icon",{attrs:{name:"magnify"}})],1),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.search,expression:"search"}],staticClass:"absolute w-full h-full rounded-t-md left-0 bg-[transparent] pl-[56px] appearance-none",attrs:{id:"search-products",title:"search products",type:"search",placeholder:"Search by product name"},domProps:{value:t.search},on:{input:function(e){e.target.composing||(t.search=e.target.value)}}})]),t._v(" "),t.getProducts.length?r("div",{staticClass:"overflow-x-auto max-w-[100%]"},[r("table",{staticClass:"w-full"},[r("caption",{staticClass:"sr-only"},[t._v("Product list")]),t._v(" "),r("thead",{staticClass:"bg-white dark:bg-blue-gray-900 dark:bg-opacity-80 fill-before before-divide before:border-b w-full relative text-left"},[r("tr",{staticClass:"min-h-[48px] h-[48px]"},t._l(t.tableHead,(function(th,i){return r("th",{key:i},[r("div",{staticClass:"px-6"},[t._v(t._s(th))])])})),0)]),t._v(" "),r("tbody",t._l(t.getProducts,(function(e,i){return r("tr",{key:i,staticClass:"fade-appear bg-white dark:bg-blue-gray-900 bg-opacity-0 dark:bg-opacity-0 hover:bg-opacity-30 dark:hover:bg-opacity-30",class:{"border-b border-black dark:border-white border-opacity-10 dark:border-opacity-10":i!=t.getProducts.length-1}},[r("td",[r("nuxt-link",{staticClass:"grid grid-flow-col gap-x-3 py-4 px-6 justify-start group",attrs:{to:"/dashboard/my-products?edit="+e.id}},[r("div",{staticClass:"h-[80px] w-[80px] rounded-sm isolate overflow-hidden transition-transform transform-gpu group-hover:translate-y-[-0.15rem] group-hover:shadow-md"},[r("app-img",{staticClass:"object-cover",attrs:{"public-id":e.background,height:"80px",width:"80px"}})],1),t._v(" "),r("div",{staticClass:"grid content-center"},[r("p",{staticClass:"opacity-70 text-sm font-normal"},[t._v(t._s(t.capitalize(e.type)))]),t._v(" "),r("span",[t._v(t._s(t.capitalize(e.productName)))])])])],1),t._v(" "),r("td",[r("div",{staticClass:"py-4 px-6"},[r("span",{staticClass:"rounded-full bg-opacity-75 dark:bg-opacity-75 text-[0.8rem] py-1 px-2 whitespace-nowrap",class:{"bg-green-800 text-white":parseInt(e.amountAvailable)>=10,"bg-yellow-500 text-black":parseInt(e.amountAvailable)<10&&parseInt(e.amountAvailable)>4,"bg-red-800 text-white":parseInt(e.amountAvailable)<5}},[t._v(t._s(t.formatRemaining(e)))])])]),t._v(" "),r("td",[r("div",{staticClass:"py-4 px-6"},[t._v("¢"+t._s(e.cost))])]),t._v(" "),r("td",[r("div",{staticClass:"py-4 px-6"},[r("app-rating",{attrs:{readonly:""}})],1)]),t._v(" "),r("td",[r("div",{staticClass:"opacity-80 text-[0.875rem] py-4 px-6 whitespace-nowrap"},[t._v(t._s(e.id))])])])})),0)])]):r("div",[r("p",{staticClass:"text-center text-lg font-bold p-10"},[t._v("No item to match your search")])])]),t._v(" "),r("div",{staticClass:"grid justify-center my-9"},[r("ui-btn",{staticClass:"bg-blue-700 text-white hover:blue-800 dark:bg-blue-400 dark:text-black dark:hover:bg-blue-500 px-6",attrs:{to:"/dashboard/create-product"}},[t._v("Create a product")])],1)])}),[],!1,null,null,null);e.default=_.exports}}]);